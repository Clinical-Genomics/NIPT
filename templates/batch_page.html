<html>
<head>
    <title>NIPT</title>

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap-theme.min.css" integrity="sha384-fLW2N01lMqjakBkx3l/M9EahuwpSfeNvV63J5ezn3uZzapT0u7EYsXMjQV+0En5r" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/startbootstrap-sb-admin-2/1.0.8/css/sb-admin-2.css">

    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js" type="text/javascript"></script>
    <script src="https://code.highcharts.com/highcharts.js" type="text/javascript"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>

</head>
<body>
    <div id="wrapper">
       <nav class="navbar navbar-default navbar-static-top" role="navigation" style="margin-bottom: 0">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="http://127.0.0.1:5000/NIPT/">Project ID</a>
            </div>
            <!-- /.navbar-header -->
    
             <div class="navbar-default sidebar" role="navigation">
                <div class="sidebar-nav navbar-collapse">
                    <ul class="nav" id="side-menu">
                        <li>
                            <a href="http://127.0.0.1:5000/NIPT/"><i class="fa fa-dashboard fa-fw"></i>Project Summary</a>
                        </li>
                        <li>
                            <a href="NCV_plots/"><i class="fa fa-table fa-fw"></i>NCV plots</a>
                        </li>
                    </ul>
                    <!-- /.dropdown-messages -->
                </div>
            </div>
        </nav>


        <div id="page-wrapper">
            <div class="row">
                <div class="col-lg-12">
                    <h1 class="page-header">Batch ID {{batch_id}}</h1>
                </div>
                <!-- /.col-lg-12 -->
            </div>
            <!-- /.row -->
            <div class="row">
                <div id = "custom-tag"> </div>
                <div class="col-lg-9">
                    <div class="panel panel-default">
                            <div class="panel-heading">
                            <h5>Batch Warnins </h5>
                            </div>
                            <div class="panel-body">
                            <div class="table-responsive">
                                <table class="table table-bordered table-striped">
                                    <thead>
                                        <tr>
                                            <th>Sample id</th>
                                            <th>Missing data</th>
                                            <th>QC Warning</th>
                                            <th>QV Failure</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {% for s in seq_warnings %}
                                        <tr>
                                            <td> <a href={{ url_for('sample_page', sample_id=s) }}>{{ s }}</a></td>
                                            <td>{seq_warnings[s]['missing_data'] }}</td>
                                            <td>{{ seq_warnings[s]['QC_warn'] }}</td>
                                            <td>{{ seq_warnings[s]['QC_fail'] }}</td>
                                        </tr>
                                        {% endfor %}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- /.col-lg-6 -->
            </div>

             <div class="row">
                <div class="col-lg-9">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                           <h5> NCV Table</h5>
                        </div>
                        <!-- /.panel-heading -->
                        <div class="panel-body">
                            <div class="table-responsive">
                                <form action="{{ url_for('update') }}" method="post">
                                <table class="table table-striped table-bordered table-hover" >
                                    <thead>
                                        <tr>
                                            <th>Sample id</th>
                                            <th>Sample type</th>
                                            <th>NCV_13</th>
                                            <th>NCV_18</th>
                                            <th>NCV_21</th>
                                            <th>NCV_X</th>
                                            <th>NCV_Y</th>
                                            <th>Chrom Warn</th>
                                            <th>Include</th>
                                            <th>Last Change</th> 
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {% for s in samples %}
                                        <tr>
                                            <td> <a href={{ url_for('sample_page', sample_id=s.sample_ID) }}>{{ s.sample_ID }}</a></td>
                                            <td>{{ s.SampleType }}</td>
                                            <td class = "{{ NCV_rounded[s.sample_ID]['NCV_13']['warn']}}">{{ NCV_rounded[s.sample_ID]['NCV_13']['val'] }}</td>
                                            <td class = "{{ NCV_rounded[s.sample_ID]['NCV_18']['warn']}}">{{ NCV_rounded[s.sample_ID]['NCV_18']['val'] }}</td>
                                            <td class = "{{ NCV_rounded[s.sample_ID]['NCV_21']['warn']}}">{{ NCV_rounded[s.sample_ID]['NCV_21']['val'] }}</td>
                                            <td class = "{{ NCV_rounded[s.sample_ID]['NCV_X']['warn']}}">{{ NCV_rounded[s.sample_ID]['NCV_X']['val'] }}</td>
                                            <td class = "{{ NCV_rounded[s.sample_ID]['NCV_Y']['warn']}}">{{ NCV_rounded[s.sample_ID]['NCV_Y']['val'] }}</td>
                                            <th>{{ warnings[s.sample_ID]['NCV_high'] }}</th>
                                            <td {% if s.include %}class="success"{% endif %}> <input type="checkbox" name="{{ s.sample_ID }}" {% if s.include %}checked{% endif %}></td>    
                                            <td >{{s.change_include_date}}</td>
                                        </tr>
                                        {% endfor %}
                                    </tbody>
                                 </table>
                                 <table>
                                    <tr>
                                        <td>
                                            <p>Samples checked in the "Include" column are added to the validation sample set for comparison. Check the checkboxes for samples and save, or if all samples are ok, just perss the "set all OK"-button."</p>
                                        </td>
                                        <input type=text name="sample_ids" value="{{sample_ids}}" hidden>
                                          <td> 
                                            <p align="right">           
                                            <input type="submit" class="btn btn-success" value="Save checked samples">
                                            </p>
                                        </td>
                                          <td> 
                                            <p align="right">            
                                            <button type="submit" class="btn btn-success" name="All samples" value="{{sample_ids}}"> Set all OK</button>
                                            </p>
                                        </td>
                                    </tr>
                                </table>
                            </form>    
                           </div>
                       </div>
                   </div>
              </div>
           </div>
    </div>
</div>


</body>
</html>

